<script>
  <%content_for :global do%>
    var height_map;
    var camera = new Camera();
  <%end%>
  
  <%content_for :init do%>
    height_map = new HeightMap(document.getElementById('heightmap'), {magnitude:5});

    world.camera.translateTo(25, 55, 70);
    world.camera.lookAt(25, 0, 35);
    context.world.addObject(height_map);
  <%end%>
  
  <%content_for :canvas_clicked do%>
    var img = new Image();
    img.onload = function() {
      document.getElementById('heightmap').src = img.src;
      height_map.image = img;
      height_map.scale = 0.75;
      height_map.invalidate();
    };
    img.src = '/images/colloquy.png';
  <%end%>
        
  <%content_for :render do %>
    context.world.camera.look(context.gl);
    context.world.render(WIREFRAME);
  <%end%>
</script>

<br/>
Height Map:
<img id="heightmap" src="/images/rails.png" alt="" />
